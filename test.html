<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bible Here Plugin Test</title>
    <link rel="stylesheet" href="public/css/bible-here-public.css">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .test-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #007cba;
        }
        .test-section {
            margin-bottom: 40px;
        }
        .test-title {
            color: #007cba;
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 15px;
            padding: 10px;
            background: #f8f9fa;
            border-left: 4px solid #007cba;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <div class="test-header">
            <h1>Bible Here Plugin - 功能測試</h1>
            <p>測試第二階段開發的聖經閱讀核心功能</p>
        </div>

        <div class="test-section">
            <div class="test-title">1. 基本聖經閱讀器測試</div>
            <div class="bible-reader-container" data-version="" data-book="" data-chapter="" data-parallel="" data-height="600" data-show-navigation="true" data-show-search="true">
                <div class="bible-reader-header">
                    <h2>聖經閱讀器</h2>
                </div>
                <div class="bible-reader-content">
                    <div class="bible-navigation">
                        <div class="bible-version-selector">
                            <label for="version-select">選擇版本:</label>
                            <select id="version-select">
                                <option value="">載入中...</option>
                            </select>
                        </div>
                        
                        <div class="bible-book-selector">
                            <label for="book-select">選擇書卷:</label>
                            <select id="book-select">
                                <option value="">請先選擇版本</option>
                            </select>
                        </div>
                        
                        <div class="bible-chapter-selector">
                            <label for="chapter-select">選擇章節:</label>
                            <select id="chapter-select">
                                <option value="">請先選擇書卷</option>
                            </select>
                        </div>
                        
                        <div class="bible-search">
                            <label for="search-input">搜索經文:</label>
                            <div class="search-input-group">
                                <input type="text" id="search-input" placeholder="輸入關鍵詞搜索...">
                                <button id="search-button">搜索</button>
                            </div>
                        </div>
                        
                        <div class="bible-parallel-selector">
                            <h4>並行版本</h4>
                            <div class="parallel-version-options">
                                <!-- 動態生成的並行版本選項 -->
                            </div>
                        </div>
                    </div>
                    
                    <div class="bible-content">
                        <div class="bible-content-header">
                            <h3 class="bible-title">請選擇版本和書卷</h3>
                            <div class="chapter-navigation">
                                <div class="chapter-nav-buttons">
                                    <button class="chapter-nav-button" id="prev-chapter" disabled>上一章</button>
                                    <button class="chapter-nav-button" id="next-chapter" disabled>下一章</button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bible-parallel-view">
                            <div class="bible-parallel-column" id="main-version">
                                <div class="bible-verses">
                                    <div class="bible-loading">載入中...</div>
                                </div>
                            </div>
                            
                            <div class="bible-parallel-column bible-hidden" id="parallel-version">
                                <div class="bible-verses">
                                    <div class="bible-loading">載入中...</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bible-search-results bible-hidden">
                            <!-- 搜索結果將在這裡顯示 -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="test-section">
            <div class="test-title">2. 經文引用測試</div>
            <p>測試經文引用功能：</p>
            <p>這是一個包含經文引用的段落 <span class="bible-reference" data-ref="約翰福音 3:16" data-version="" data-format="popup">約翰福音 3:16</span>，點擊應該顯示經文內容。</p>
            <p>另一個引用：<span class="bible-reference" data-ref="詩篇 23:1" data-version="" data-format="inline">詩篇 23:1</span></p>
        </div>

        <div class="test-section">
            <div class="test-title">3. 響應式設計測試</div>
            <p>請調整瀏覽器窗口大小來測試響應式設計：</p>
            <ul>
                <li>桌面端：導航欄在左側，內容在右側並排顯示</li>
                <li>平板端：並行版本上下顯示</li>
                <li>移動端：導航欄在上方，內容在下方，彈出框變為模態框</li>
            </ul>
        </div>
    </div>

    <!-- 經文引用彈出框 -->
    <div class="bible-popup bible-hidden">
        <div class="bible-popup-overlay"></div>
        <div class="bible-popup-content">
            <div class="bible-popup-header">
                <span class="bible-popup-title">載入中...</span>
                <button class="bible-popup-close">&times;</button>
            </div>
            <div class="bible-popup-text">
                載入中...
            </div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="public/js/bible-here-public.js"></script>
    <script>
        // 模擬WordPress AJAX環境
        window.bible_here_ajax = {
            ajax_url: 'test-ajax.php', // 在實際環境中這會是WordPress的admin-ajax.php
            nonce: 'test-nonce'
        };
        
        // 模擬AJAX響應用於測試
        var originalAjax = jQuery.ajax;
        jQuery.ajax = function(options) {
            console.log('模擬AJAX請求:', options.data.action);
            
            // 模擬延遲
            setTimeout(function() {
                var mockResponse;
                
                switch(options.data.action) {
                    case 'bible_here_get_versions':
                        mockResponse = {
                            success: true,
                            data: {
                                versions: [
                                    {version: 'CUV', name: '和合本'},
                                    {version: 'NIV', name: 'New International Version'}
                                ],
                                books: [
                                    {book_name: '創世記', chapters: 50},
                                    {book_name: '出埃及記', chapters: 40},
                                    {book_name: '約翰福音', chapters: 21}
                                ]
                            }
                        };
                        break;
                        
                    case 'bible_here_get_verses':
                        mockResponse = {
                            success: true,
                            data: {
                                verses: [
                                    {verse_number: 1, verse_text: '起初，神創造天地。'},
                                    {verse_number: 2, verse_text: '地是空虛混沌，淵面黑暗；神的靈運行在水面上。'}
                                ]
                            }
                        };
                        break;
                        
                    case 'bible_here_search':
                        mockResponse = {
                            success: true,
                            data: {
                                results: [
                                    {
                                        version: 'CUV',
                                        book_name: '約翰福音',
                                        chapter_number: 3,
                                        verse_number: 16,
                                        verse_text: '神愛世人，甚至將他的獨生子賜給他們，叫一切信他的，不至滅亡，反得永生。'
                                    }
                                ]
                            }
                        };
                        break;
                        
                    default:
                        mockResponse = {success: false, data: 'Unknown action'};
                }
                
                if (options.success) {
                    options.success(mockResponse);
                }
            }, 500);
        };
        
        // 初始化聖經閱讀器
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Bible Here Plugin Test Page Loaded');
            console.log('CSS和JavaScript文件已載入，可以測試樣式和基本功能');
            
            // 測試CSS樣式是否正確載入
            const readerContainer = document.querySelector('.bible-reader-container');
            if (readerContainer) {
                console.log('✓ 聖經閱讀器容器已找到');
            }
            
            // 測試JavaScript功能是否可用
            if (typeof BibleHereReader !== 'undefined') {
                console.log('✓ BibleHereReader對象已載入');
            } else {
                console.log('⚠ BibleHereReader對象未找到，可能需要WordPress環境');
            }
        });
    </script>
</body>
</html>